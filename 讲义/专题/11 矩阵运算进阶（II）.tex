\chapter{矩阵运算进阶（II）}

本讲我们将讨论技巧性更强的一些内容，包括一些特殊矩阵的性质，矩阵可交换的问题，矩阵的逆的进阶求法
以及矩阵的幂的求解.本将讨论的大部分问题都是了解为主，需要理解领悟的内容不多，但是对于将来我们拿到一个
问题有更好的洞察也是很重要的.

\section{特殊矩阵}
本节将会介绍一些常见的特殊矩阵以及它们常用的基本性质，还有一些将在特征值专题中讲解.
\subsection{对角矩阵}
我们一般记主对角矩阵为$\diag(d_1,d_2,\dots,d_n)$，准对角矩阵为$\diag(A_1,A_2,\dots,A_n)$.
下面是对角矩阵的一个基本定理，它很简单，但是很重要：
\begin{theorem}
    设$A$是一个$s \times n$矩阵，把$A$写成列向量与行向量的形式，分别为

    \[ A = \begin{pmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_n\end{pmatrix} = \begin{pmatrix} \beta_1 \\ \beta_2 \\ \vdots \\ \beta_n \end{pmatrix} \]
    则
    \begin{gather*}
        \begin{pmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_n\end{pmatrix}
        \begin{pmatrix}
            d_1 & & & \\
            & d_2 & & \\
            & & \ddots & \\
            & & & d_n
        \end{pmatrix} = \begin{pmatrix}d_1\alpha_1 & d_2\alpha_2 & \cdots & d_n\alpha_n\end{pmatrix} \\
        \begin{pmatrix}
            d_1 & & & \\
            & d_2 & & \\
            & & \ddots & \\
            & & & d_n
        \end{pmatrix} \begin{pmatrix} \beta_1 \\ \beta_2 \\ \vdots \\ \beta_n \end{pmatrix} = \begin{pmatrix} d_1\beta_1 \\ d_2\beta_2 \\ \vdots \\ d_n\beta_n \end{pmatrix}
    \end{gather*}

    即$A$右乘对角矩阵$\diag(d_1,d_2,\ldots,d_n)$相当于给$A$的第$i$列元素都乘以$d_i$，
    $A$左乘对角矩阵$\diag(d_1,d_2,\ldots,d_n)$相当于给$A$的第$i$行元素都乘以$d_i$.
\end{theorem}
\begin{theorem}
    （请自行完成以下内容的补充）

    对角矩阵以及准对角矩阵的三则运算、可逆性以及逆运算、乘方运算等规则.
\end{theorem}

\subsection{上（下）三角矩阵}
\begin{theorem}
    已知$A,B$都是上三角矩阵，且设$A$的主对角元素分别为$a_{11},\ldots,a_{nn}$，B的主对角元素分别为
    $b_{11},\ldots,b_{nn}$，则
    \begin{enumerate}
        \item $A^{\mathrm{T}}, B^\mathrm{T}$都是下三角矩阵；

        \item $AB$仍然是上三角矩阵，且$AB$的主对角元素为$a_{11}b_{11},\ldots,a_{nn}b_{nn}$；

        \item $A$可逆的充要条件是其主对角元均不为0，且$A$可逆时，$A^{-1}$也是上三角矩阵，并且$A^{-1}$的主对角元素分别为$a_{11}^{-1},\ldots,a_{nn}^{-1}$.
    \end{enumerate}
\end{theorem}

\begin{example}
    已知$A_1,\ldots,A_n$是$n$个对角元都为0的上三角矩阵，证明：$A_1A_2\cdots A_n=O$.
\end{example}

\subsection{基本矩阵}
只有一个元素为1，其余元素全为0的矩阵称为基本矩阵，第$i$行第$j$列元素为1的基本矩阵记为$E_{ij}$，
他们具有如下性质（可以回忆左右乘对应行列变换）：
\begin{theorem}
    \begin{enumerate}
        \item $AE_{ij}$的结果就是把$A$的第$i$列移到第$j$列的位置，其余元素都为0的矩阵；

        \item $E_{ij}B$的结果就是把$B$的第$j$行移到第$i$行的位置，其余元素都为0的矩阵；

        \item $E_{ik}E_{kj}=E_{ij}$，当$k \neq l$时，有$E_{ik}E_{lj}=O$.
    \end{enumerate}
\end{theorem}

\subsection{其他矩阵}
其他矩阵如正交矩阵、置换矩阵、幂等矩阵、幂零矩阵等，有的会在稍后介绍部分性质，有的
则会在课程进行中或者后续课程中再见到它们.

\section{矩阵可交换问题}
一般来说在本课程中此类问题直接设可交换矩阵的每一个元素都是未知数即可，一些特殊的技巧
（使用关于一些特殊形状矩阵的结论）以及涉及到之后才能学到的知识的方法我们在这里也不展开了.我们只讨论一个基本的技巧，即
\[\forall t,\enspace AB=BA \iff (A-tE)B=B(A-tE)\]
此处的$t$根据矩阵的对角线上元素来决定，原则是使得其余矩阵与$A-tE$相乘的计算过程更为简单（一般是使得0元素更多），这样解方程也会更轻松.
我们来看一个简单的例子：
\begin{example}
    求与矩阵$A=\begin{pmatrix}
        3 & 0 & 0 \\ -1 & 3 & 0 \\ 0 & -1 & 3
    \end{pmatrix}$可交换的矩阵.
\end{example}

关于可交换我们有以下定理，证明并不是很复杂（教材习题中有出现）：
\begin{theorem}
    \begin{enumerate}
        \item 与主对角元两两互异的对角矩阵可交换的方阵只能是对角矩阵；

        \item 准对角矩阵$A$每个对角分块内对角线元素相同，但不同对角块之间不同，则与$A$可交换的矩阵只能是准对角矩阵；

        \item 与所有$n$级可逆矩阵可交换的矩阵为数量矩阵；

        \item 与所有$n$级矩阵可交换的矩阵为数量矩阵.
    \end{enumerate}
\end{theorem}

\section{矩阵的逆进阶求法}
\subsection{给定多项式求逆矩阵}
此类题目相信大家已经有所见识，实际上就是通过一些初中所学的因式分解等基本变换得到需要求逆的矩阵与另一个矩阵相乘
可以得到单位矩阵（的一个倍数）.
\begin{example}
    设$A$为非零矩阵，且$A^3=O$，证明：$E+A$和$E-A$都可逆.
\end{example}

\begin{example}
    若$X$，$Y$是两个列向量，且$X^\mathrm{T}Y=2$，证明：
    \begin{enumerate}
        \item $(XY^\mathrm{T})^k=2^{k-1}(XY^{\mathrm{T}})$；

        \item 如果$A=E+XY^\mathrm{T}$，则$A$可逆，并求其逆矩阵.
    \end{enumerate}
\end{example}

\subsection{利用分块矩阵初等变换}
我们在前面已经讲解过了打洞法的基础题型，这里再给出一些例子：
\begin{example}
    设$A$、$B$为$n$阶矩阵，证明：若$E\pm AB$可逆，则$E\pm BA$可逆.
\end{example}
\begin{example}
    设$A$为$n$阶矩阵，$B$、$C$分别为$n \times m$、$m \times n$阶矩阵，
    证明：$E_m+CA^{-1}B$可逆$\iff A+BC$可逆.
\end{example}

\subsection{求逆的分式思想}
虽然矩阵没有除法运算，但是我们如果将$(E-A)^{-1}$写成$\dfrac{E}{E-A}$，再类比泰勒展开
\[\frac{1}{1-x}=1+\sum_{n=1}^\infty x^n \quad x\in (-1,1)\]我们可以得到（不严谨！只能用来解题的时候当作初步的思路！）
\[(E-A)^{-1}=\frac{E}{E-A}=E+A+A^2+\cdots\]

\begin{example}
    已知方阵$A$满足$A^k=O$，其中$k$是一个正整数，求$E-A$的逆.
\end{example}

\begin{example}
    设$A$，$B$分别是$n \times m$和$m \times n$的矩阵，且$E_n \pm AB$可逆，则$E_m \pm BA$可逆.
\end{example}
不难发现这一例是前述4.3.1节中最后一个例题的推广. % TODO 编号

\subsection{提逆思想}
这一思想的来源是矩阵逆没有加减相关的运算法则，因此我们需要提逆产生一些乘积项来解决问题.
\begin{example}
    设$A$是$n$阶方阵，且$E-A$，$E+A$和$A$都可逆，证明：$(E-A^{-1})^{-1}+(E-A)^{-1}=E$.
\end{example}

\section{矩阵的迹}
\subsection{基本概念与性质}
\begin{definition}
    一个方阵$A$的所有主对角元素之和称为$A$的迹，记为$\tr(A)$.
\end{definition}
迹的常见性质如下：
\begin{theorem}
    已知$A, B$是两个$n$阶矩阵，$k$是一个常数，则
    \begin{enumerate}
        \item $\tr(kA) = k\tr(A)$；

        \item $\tr(A+B)=\tr(A)+\tr(B)$；

        \item $\tr(AB)=\tr(BA)$；

        \item 如果$A$是实矩阵，则$A=O \iff \tr(A^{\mathrm{T}}A)=0$.
    \end{enumerate}
\end{theorem}

我们先来看一个基本的例子练习一下：
\begin{example}
    证明：不存在方阵$A$、$B$使得$AB-BA=E$.
\end{example}

接下来我们介绍一个性质，这一性质的证明需要利用矩阵的秩中讲到的一些技巧：
\begin{theorem}
    已知 $n$ 阶矩阵 $A$ 的秩为 1，证明：$A^k=\tr(A)^{k-1}A$.
\end{theorem}
这一定理的证明需要用到矩阵的分解，在2020年吴志祥老师班期中考试有出现，可以参考
辅学网站上的解答.

当然我们还会在特征值一章再次见到矩阵的迹，相关内容在最后一个专题会展开讲述.

\subsection{幂零矩阵}
幂零矩阵是一种特殊的矩阵，幂零矩阵$A$存在一个正整数$k$使得$A^k=O$，
它具有如下性质（部分需要用到特征值，所以最后一个专题还会提及）：
\begin{theorem}
    若$n$阶矩阵$A$为幂零矩阵，则
    \begin{enumerate}
        \item $A^n=O$；

        \item $A\pm E$均为可逆矩阵；

        \item 幂零矩阵对应的线性变换一定存在一个矩阵表示使得矩阵为上三角矩阵且对角线元素全为0；

        \item $A$ 为幂零矩阵 $\iff \forall k \in \mathbf{N}_+,\enspace\tr(A^k)=0$.
    \end{enumerate}
\end{theorem}

\begin{example}
    若$A$、$B$为两个$n$阶矩阵且满足$AB-BA=A$，证明：
    \begin{enumerate}
        \item $A$不可逆；

        \item $A$是幂零矩阵.
    \end{enumerate}
\end{example}

\section{矩阵的幂}
\begin{enumerate}
    \item 找规律

    在矩阵的转置中我们已经见识了一种找规律的方式，下面是一种类似的题型：
    \begin{example}
        计算$(PAQ)^k$，其中
        \[P=\begin{pmatrix}2 & 3 \\ 1 & 2\end{pmatrix},\enspace A=\begin{pmatrix}2 & 0 \\ 0 & -1\end{pmatrix},\enspace Q=\begin{pmatrix}2 & -3 \\ -1 & 2\end{pmatrix}\]
    \end{example}

    \begin{example}
        设$A=\begin{pmatrix}0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & -1 \end{pmatrix},\enspace P^{-1}AP=B$，求$B^{2004}-2A^2$.
    \end{example}

    还有一种找规律基于幂等矩阵，显然幂等矩阵的任意次方都与其平方相等是很好的性质，另一种找规律基于对合矩阵，即平方等于单位矩阵的矩阵，我们这里
    主要与大家分享关于幂零矩阵的方法，例子如下：
    \begin{example}
        求$A=\begin{pmatrix}a & 1 & 0 & 0 \\ 0 & a & 1 & 0 \\ 0 & 0 & a & 0 \\ 0 & 0 & 0 & a \end{pmatrix}^n$.
    \end{example}
    在上例中，我们采用将矩阵分为$A=tE+B$的方法，会发现矩阵$B$为上三角矩阵且对角线上全为0，是典型的幂零矩阵，利用这一性质可以快速解题.
    \item 数学归纳法
    \begin{example}
        求$A=\begin{pmatrix}\cos\alpha & \sin\alpha \\ -\sin\alpha & \cos\alpha\end{pmatrix}^n$.
    \end{example}
    这一问题对应我们常见的旋转变换.
    \begin{example}
        证明$\begin{pmatrix}
            a & c \\ 0 & b
        \end{pmatrix}^n=\begin{pmatrix}
            a^n & (a^{n-1}+a^{n-2}b+\dots+b^{n-1})c \\ 0 & b^n
        \end{pmatrix}$.
    \end{example}
    \item 利用秩为1的矩阵

    在我们有关秩的讨论中已经提到了如果$A$是秩为1的矩阵，那么$A^n=\tr(A)^{n-1}A$，我们可以利用这一性质解决问题.
    \begin{example}
        已知$M$是秩为 1 的矩阵，记$\tr(M)=b$，讨论$(aE+M)^n$的计算结果.
    \end{example}

    \begin{example}
        已知$A$是数域$P$上的一个2阶方阵，且存在正整数$l$使得$A^l=O$，证明：$A^2=O$.
    \end{example}
    事实上，我们在幂零矩阵的讨论中已经提及了上例的一般情况.

    \begin{example}
        已知数列$\{a_n\},\enspace\{b_n\}$满足$a_0=-1,\enspace b_0=3$，且
        \[\begin{cases}
            a_n=3a_{n-1}+b_{n-1}+2^{n-1} \\ b_n=2a_{n-1}+4b_{n-1}+2^n
        \end{cases}\]
        求$\{a_n\}\enspace\{b_n\}$的通项公式.
    \end{example}
    \item 利用初等矩阵的性质
    \begin{example}
        设$A$为三阶矩阵，$P$为三阶可逆矩阵，$P^{-1}AP=B$，其中$P=\begin{pmatrix}
            0 & 2 & -1 \\ 1 & 1 & 2 \\ -1 & -1 & -1
        \end{pmatrix}$，$B=\begin{pmatrix}
            0 & 0 & -1 \\ 0 & -1 & 0 \\ -1 & 0 & 0
        \end{pmatrix}$，求$A^{2022}$.
    \end{example}

    \item 利用对角化

    若一个矩阵$A$可对角化，即存在可逆矩阵$P$使得$A=P^{-1}\Lambda P$（其中$\Lambda$为对角矩阵），
    在这种形式下$A$的幂是很好求的.
    \begin{example}
        已知$A=\begin{pmatrix}
            0 & \cfrac{1}{2} & \cfrac{1}{2} \\ 1 & -\cfrac{1}{2} & \cfrac{1}{2} \\ 1 & -\cfrac{1}{2} & \cfrac{1}{2}
        \end{pmatrix}$，求$A^n$.
    \end{example}

\end{enumerate}

\vspace{2ex}
\centerline{\heiti \Large 内容总结}

\vspace{2ex}

\centerline{\heiti \Large 习题}
\vspace{2ex}
{\kaishu }
\begin{flushright}
    \kaishu

\end{flushright}
\centerline{\heiti A组}
\begin{enumerate}
    \item
\end{enumerate}
\centerline{\heiti B组}
\begin{enumerate}
    \item
\end{enumerate}
\centerline{\heiti C组}
\begin{enumerate}
    \item
\end{enumerate}
